#Example of querying a database with multiple tables to determine and quantify statistics about customer and order data including information such as average amount spent. 

----Identifying how many unique orders were placed in January
SELECT COUNT(distinct orderid)
FROM BIT_DB.JanSales
WHERE length(orderid) = 6
AND orderid <> 'Order ID';

--Identifying how many orders in January were for an iPhone
SELECT COUNT(distinct orderid)
FROM BIT_DB.JanSales
WHERE length(orderid) = 6
AND orderid <> 'Order ID'
AND Product='iPhone';


--Determining the customer account numbers for all orders that were placed 
SELECT distinct acctnum
FROM BIT_DB.customers
INNER JOIN BIT_DB.FebSales
ON BIT_DB.customers.order_id=BIT_DB.FebSales.orderID
WHERE length(orderid)=6
AND orderid<>'Order ID'; 

--Identifying the cheapest product sold in January and the price of that product 
SELECT distinct 
product, MIN(price)
FROM BIT_DB.JanSales
GROUP BY product
ORDER BY price ASC
LIMIT 1
; 


--Determining the total revenue for each product sold in January 
SELECT sum(quantity)*price as revenue, product
FROM BIT_DB.JanSales
GROUP BY product;

--Determining which products were sold in Feb. at 548 Lincoln St., Seattle, WA 98101, how many of each item were sold and what the total revenue was
SELECT
sum(Quantity),
product,
sum(quantity)*price as revenue
FROM BIT_DB.FebSales
WHERE location = '548 Lincoln St, Seattle, WA 98101'
GROUP BY product;

--Identifying how many customers ordered more than 2 products at a time in Feb., and what was the average amount spent for each of those customers
SELECT count(distinct cust.acctnum),
avg(quantity*price)
FROM customers cust
LEFT JOIN FebSales Feb
ON feb.orderID=cust.order_id
WHERE feb.Quantity>2
AND length(orderid)=6
AND orderid<>'Order ID';
